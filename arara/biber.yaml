!config
identifier: biber
name: Biber
authors:
- Luigi Pertoldi
commands:
- name: The Biber reference management software
  command: >
    @{
        bibfile = toFile(builddir + "/" + getBasename(file) + ".bbl");
        foreach(ref : listFilesByExtensions("bib", ["bib"], true)) {
            if (missing(bibfile) || changed(ref)) {
                return getCommand('biber', '--output-directory', builddir,
                                  options, getBasename(file));
            }
        }
        return true;
    }
arguments:
- identifier: options
  flag: >
    @{
        if (isList(parameters.options)) {
            return parameters.options;
        }
        else {
            throwError('I was expecting a list of options.');
        }
    }
- identifier: builddir
  flag: >
      @{
          return parameters.builddir;
        }
