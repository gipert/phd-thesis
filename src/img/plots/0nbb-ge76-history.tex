%! TEX program = xelatex
\documentclass[tikz]{standalone}
\usepackage[lining]{ebgaramond}
\usepackage[math-style=ISO, bold-style=ISO]{unicode-math}
\setmathfont{Garamond-Math.otf}
\usepackage{pgfplots}
\usetikzlibrary{shapes, positioning}
\input{../../tex/paultolcolors}

\pgfplotsset{
  width=0.95\textwidth,
  height=7cm,
  scale only axis,
  xmin=1960, xmax=2022,
  compat=1.16
}

\tikzstyle{BI} = [
  mark=*,
  mark size=1pt,
  mark options={solid},
  line width=0.5pt,
  densely dashdotted
]

\tikzstyle{Thalf} = [
  mark=*,
  mark size=2pt,
  line width=1pt,
  /pgfplots/error bars/error bar style={line width=1pt},
  /pgfplots/error bars/error mark options={line width=1pt, rotate=90}
]

\tikzstyle{anatmarker} = [regular polygon, regular polygon sides=3, draw, thick, scale=0.38]
\tikzstyle{unatmarker} = [regular polygon, regular polygon sides=3, fill, scale=0.45]
\tikzstyle{uenrmarker} = [circle, fill, scale=0.7]

\begin{document}
  \begin{tikzpicture}
    \begin{semilogyaxis}[
      axis y line*=left,
      axis x line=none,
      ylabel={background index (cts/keV$\cdot$kg$\cdot$yr)},
      ymin=1E-4, ymax=1E4,
      xlabel={},
      grid=major
    ]
      % Milano
    \addplot[style=BI, TolMutGreen] coordinates {
          (1965.19, 1176.209)
          (1967.10, 278.5697)
          (1970.07, 116.4338)
          (1982.68, 11.76209)
          (1983.14, 1.711907)
      };
      % UCSB/LBL
      \addplot[style=BI, TolMutIndigo] coordinates {
          (1984.20, 11.52)
          (1985.23, 2.013)
          (1987.10, 1.397)
          (1990.11, 1.237)
      };
      % HdM
      \addplot[style=BI, TolMutWine] coordinates {
          (1992.17, 0.422)
          (1994.19, 0.249)
          (1997.12, 0.166)
          (1998.68, 0.141)
          (2000.43, 0.150)
          (2000.97, 0.042)
      };

      % Majorana
      \addplot[style=BI, TolVibCyan] coordinates {
        (2018.33, 0.0016)
        (2019.10, 0.0047)
      };

      % GERDA
      \addplot[style=BI, TolVibRed] coordinates {
          (2012.09, 0.010308)
          (2015.75, 0.001041)
          (2017.42, 0.000922)
          (2018.33, 0.000570)
      };
    \end{semilogyaxis}

    \begin{semilogyaxis}[
      /pgf/number format/1000 sep=,
      axis y line*=right,
      xlabel={},
      ylabel={$T_{1/2}^{0\upnu}$ lower limit (yr)},
      ymin=1E20, ymax=1E28,
      legend pos=north west,
      scatter,
      point meta=explicit symbolic,
      scatter/classes={
        uenr={mark=circle*},
        unat={mark=triangle*},
        anat={mark=triangle*, fill=white, line width=0.7pt}
      },
      legend style={
        draw=none,
        legend cell align=left,
        at={(0.3,0.95)}, anchor=north
      },
    ]
      \addlegendimage{no marks, style=Thalf, black};
      \addlegendentry{$T^{0\upnu}_{1/2}$ lower limit};
      \addlegendimage{style=BI, black};
      \addlegendentry{background index};

      \draw[fill=white, draw=none] (axis cs:1988.5, 2e+20) rectangle (axis cs:2012, 3e+21);
      \node[anatmarker] (a) at (axis cs:1990, 1.5e+21) {};
      \node[unatmarker, right=1ex of a] (b) {};
      \node[right=0ex of b, anchor=west] (c) {$^\text{nat}$Ge};
      \node[uenrmarker, right=1ex of c] (d) {};
      \node[right=0ex of d, anchor=west] (e) {$^\text{enr}$Ge};

      \node[anatmarker, below=2ex of a] (f) {};
      \node[right=0ex of f] (g) {/};
      \node[unatmarker, right=0ex of g] (h) {};
      \node[uenrmarker, right=1ex of h] (i) {};
      \node[right=0ex of i, anchor=west] {under / above ground};

      % Milano
      \node[TolMutGreen, fill=white] at (axis cs:1976, 3.0e+22) {Milano};
      \addplot[style=Thalf, TolMutGreen] table[x=year, y=thalf, meta=label] {
        year    thalf     label
        1966.95 3.216e+20 anat
        1968.93 1.327e+21 unat
        1972.97 4.954e+21 unat
        1981.96 2.004e+22 unat
        1983.10 1.241e+23 unat
      };
      \node[fill=white] (1) at (axis cs: 1966.95, 1e+22) {0.01};
      \draw (1) -- (axis cs: 1966.95, 3.216e+20);
      \node[fill=white] (2) at (axis cs: 1981.96, 3e+21) {0.3};
      \draw (2) -- (axis cs: 1981.96, 2.004e+22);

      % ITEP/IeP
      \addplot[style=Thalf, TolVibOrange] coordinates {
        (1990.03, 1.836e+24)
      };
      \node[fill=white] (3) at (axis cs: 1990.07, 1e+26) {15};
      \draw (3) -- (axis cs: 1990.03, 1.836e+24);
      \node[TolVibOrange, align=center, fill=white]
        at (axis cs:1990, 1e+25) {ITEP/ \\ IePY};

      % UCSB/LBL
      \node[TolMutIndigo, fill=white] at (axis cs:1980, 5.0e+23) {UCSB/LBL};
      \addplot[style=Thalf, TolMutIndigo] table[x=year, y=thalf, meta=label] {
        year    thalf     label
        1983.90 5.194e+22 anat
        1984.97 2.522e+23 unat
        1986.99 4.921e+23 unat
        1990.07 1.249e+24 unat
      };
      \node[fill=white] (4) at (axis cs: 1984.97, 1e+22) {1.5};
      \draw (4) -- (axis cs: 1984.97, 2.522e+23);
      \node[fill=white] (5) at (axis cs: 1990.07, 1e+22) {23};
      \draw (5) -- (axis cs: 1990.07, 1.249e+24);

      % St. Gotthard
      \node[TolMutRose, fill=white] at (axis cs:1991, 7e+22) {St.~Gotthard};
      \addplot[style=Thalf, TolMutRose] table[x=year, y=thalf, meta=label] {
        year    thalf     label
        1987.98 1.648e+23 unat
        1991.02 5.787e+23 unat
      };
      % IGEX
      \addplot[style=Thalf, TolMutTeal] coordinates {
          (1997.92, 6.851e+24)
          (2000.93, 1.449e+25)
      }; \node[TolMutTeal, fill=white] at (axis cs:1999, 3e+24) {IGEX};

      % HdM
      \node[TolMutWine, align=center, fill=white]
         at (axis cs:1997, 8.0e+25) {Heidelberg \\ Moscow};
      \addplot[style=Thalf, TolMutWine] coordinates {
          (1991.98, 1.411e+24)
          (1994.22, 5.709e+24)
          (1997.00, 1.091e+25)
          (1999.06, 1.572e+25)
          (2000.81, 1.886e+25)
          (2002.11, 1.886e+25)
      };
      \node[fill=white] (6) at (axis cs: 2002.11, 1e+27) {470};
      \draw (6) -- (axis cs: 2002.11, 1.886e+25);

      % KKDC claim
      \node[TolMutOlive, align=center, fill=white]
        at (axis cs:2008, 1.3e+25) {KKDC \\ Claim};
      \addplot[style=Thalf, TolMutOlive,
               error bars/.cd, y dir=both, y explicit,
              ] coordinates {
          (2003.90, 1.283e+25) += (0.0, 1.662e+25) -= (0.0, 0.767e+25)
      };

      % GERDA
      \addplot[style=Thalf, TolVibRed] coordinates {
        (2013.41, 2.5e+25)
        (2016.50, 5.3e+25)
        (2017.33, 8.0e+25)
        (2018.33, 9.0e+25)
      };
      \node[fill=white] (7) at (axis cs: 2013.41, 1e+27) {215};
      \draw (7) -- (axis cs: 2013.41, 2.5e+25);
      \node[fill=white] (8) at (axis cs: 2018.33, 1e+27) {?};
      \draw (8) -- (axis cs: 2018.33, 8.0e+25);
      \node[TolVibRed, fill=white] at (axis cs:2014, 2.0e+26) {\textsc{Gerda}};

      % Majorana
      \addplot[style=Thalf, TolVibCyan] coordinates {
        (2018.33, 1.9e+25)
        (2019.10, 2.7e+25)
      };
      \node[fill=white] (9) at (axis cs: 2019.10, 1e+24) {?};
      \draw (9) -- (axis cs: 2019.10, 2.7e+25);
      \node[TolVibCyan, fill=white] at (axis cs:2016.5, 5.0e+24) {\textsc{Majorana}};
    \end{semilogyaxis}
  \end{tikzpicture}
\end{document}
