%! TEX program = xelatex
\input{../../../../../../../tex/standalone-def.tex}
\import{}{pgfplots-def}
\input{tex/gmodel-common}

\begin{document}
  \begin{tikzpicture}
    \begin{groupplot}[hide axis]

      \pgfplotstableread{data/gerda_data_bkgmodel_phaseII_v07_00_lar_M1_enrBEGe.csv}\loadedtable;
      \nextgroupplot[spectrum, ymode=log]

      \addplot[data] table {\loadedtable} \closedcycle;
      \addplot[Ac228] table {\loadedtable};
      \addplot[Th228] table {\loadedtable};
      \addplot[U238] table {\loadedtable};
      \addplot[Co60] table {\loadedtable};
      \addplot[K40] table {\loadedtable};
      \addplot[K42] table {\loadedtable};
      \addplot[2nbb] table {\loadedtable};
      \addplot[model] table {\loadedtable};

      \node[anchor=north east] at (axis description cs:0.95,0.9) {\textsc{BEGe} -- 32.1 kg$\cdot$yr};
      \node[anchor=north east] at (axis description cs:0.95,0.77) {\footnotesize single-detector events};

      \nextgroupplot[residuals]

      \addplot[3sigu] table {\loadedtable};
      \addplot[3sigl] table {\loadedtable};
      \addplot[3sigb] fill between [of=3sigu and 3sigl];
      \addplot[2sigu] table {\loadedtable};
      \addplot[2sigl] table {\loadedtable};
      \addplot[2sigb] fill between [of=2sigu and 2sigl];
      \addplot[1sigu] table {\loadedtable};
      \addplot[1sigl] table {\loadedtable};
      \addplot[1sigb] fill between [of=1sigu and 1sigl];
      \addplot[ratio] table {\loadedtable};

    \end{groupplot}

    \begin{groupplot}
      \nextgroupplot[spectrum, ymode=log]
      \nextgroupplot[residuals]
    \end{groupplot}
  \end{tikzpicture}
\end{document}
