%! TEX program = xelatex
\input{../../../../../../../tex/standalone-def.tex}
\import{}{pgfplots-def}

\pgfplotsset{%
  width=7.8cm,
  group style={%
    group size=2 by 1,
    ylabels at=edge left,
    yticklabels at=edge left,
    vertical sep=2pt,
    horizontal sep=5pt,
  },
  every tick label/.append style={font=\small},
  group/every plot/.style={
    x label style={at={(axis description cs:0.5,1)},anchor=south},
    typeset ticklabels with strut,
    ymin=3E-6, ymax=4E-2,
    xtick={1,2,3,4,5,6},
    xticklabels={\Ac,\Th,\Co,\kvz,\Uh,\textbf{SUM}},
    ylabel={BI (\ctsper)},
    ytick pos=both,
    % grid=both,
    legend pos=south east,
    % legend style={draw=black},
    only marks,
    mark size=1.2pt,
    error bars/x dir=both,
    error bars/x explicit,
    error bars/y dir=both,
    error bars/y explicit,
    table/col sep=space,
    table/x=id,
  },
  raw BEGe/.style={%
    TolVibBlue, mark=*,
    table/y expr={\thisrow{margmode}},
    table/y error minus expr={(\thisrow{margmode}-\thisrow{16qt})},
    table/y error plus expr={(\thisrow{84qt}-\thisrow{margmode})}
  },
  raw SemiCoax/.style={%
    TolVibBlue, mark=*,
    table/y expr={\thisrow{margmode}},
    table/y error minus expr={(\thisrow{margmode}-\thisrow{16qt})},
    table/y error plus expr={(\thisrow{84qt}-\thisrow{margmode})}
  },
  raw All/.style={%
    TolVibBlue, mark=*,
    table/y expr={\thisrow{margmode}},
    table/y error minus expr={(\thisrow{margmode}-\thisrow{16qt})},
    table/y error plus expr={(\thisrow{84qt}-\thisrow{margmode})}
  },
  lar BEGe/.style={%
    TolVibRed, mark=*,
    table/y expr={\thisrow{margmode}},
    table/y error minus expr={(\thisrow{margmode}-\thisrow{16qt})},
    table/y error plus expr={(\thisrow{84qt}-\thisrow{margmode})}
  },
  lar SemiCoax/.style={%
    TolVibRed, mark=*,
    table/y expr={\thisrow{margmode}},
    table/y error minus expr={(\thisrow{margmode}-\thisrow{16qt})},
    table/y error plus expr={(\thisrow{84qt}-\thisrow{margmode})}
  },
  lar All/.style={%
    TolVibRed, mark=*,
    table/y expr={\thisrow{margmode}},
    table/y error minus expr={(\thisrow{margmode}-\thisrow{16qt})},
    table/y error plus expr={(\thisrow{84qt}-\thisrow{margmode})}
  },
}

\begin{document}
  \begin{tikzpicture}
    \begin{groupplot}

      \nextgroupplot[ymode=log, xlabel=\enrBEGeII]

      \addplot[raw BEGe] table {%
        iso   id margmode 16qt      84qt
        Ac228 1  2.78e-05 2.243e-05 3.321e-05
        Th228 2   0.00323 0.0030019 0.0034729
        Co60  3  0.000327 0.0002666 0.0003882
        K42   4    0.0054 0.0047050 0.0063322
        U238  5   0.00267 0.0025141 0.0028509
        tot   6   0.01695 0.0162263 0.0176805
      };

      \addplot[lar BEGe] table {%
        iso   id margmode 16qt      84qt
        Ac228 1  3.02e-05 2.590e-05 3.476e-05
        Th228 2  3.16e-05 2.194e-05 4.380e-05
        Co60  3  1.35e-05 7.138e-06 3.840e-05
        K42   4  0.001335 0.0008038 0.0017161
        U238  5  0.000575 0.0005168 0.0006314
        tot   6  0.00678  0.0063568 0.0072396
      };

      \addlegendentry{Before cuts};
      \addlegendentry{After LAr cut};

      \nextgroupplot[ymode=log, xlabel=\enrCoaxII]

      \addplot[raw SemiCoax] table {%
        iso   id margmode 16qt      84qt
        Ac228 1  2.74e-05 2.215e-05 3.285e-05
        Th228 2   0.00215 0.0019892 0.0023021
        Co60  3  0.000315 0.0002590 0.0003770
        K42   4     0.005 0.0044191 0.0055648
        U238  5   0.00187 0.0017456 0.0019795
        tot   6  0.012475 0.0119362 0.0129765
      };

      \addplot[lar SemiCoax] table {%
        iso   id margmode  16qt      84qt
        Ac228 1  2.98e-05  2.556e-05 3.430e-05
        Th228 2  2.49e-05  1.664e-05 3.321e-05
        Co60  3  1.75e-05  9.072e-06 4.871e-05
        K42   4  0.001965  0.0015314 0.0023760
        U238  5  0.0004125 0.0003730 0.0004555
        tot   6  0.00545   0.0049908 0.0057305
      };

    \end{groupplot}
  \end{tikzpicture}
\end{document}
